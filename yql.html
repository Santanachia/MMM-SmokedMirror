<html><head><script src="https://yui-s.yahooapis.com/3.8.0/build/yui/yui-min.js"></script><script>
YUI().use('node', 'event', 'yql', function(Y) {
  var stationID = 488
  var yql = 'http://powietrze.gios.gov.pl/pjp/current/station_details/table/' + stationID + '/1/0'
  yql = 'SELECT * FROM html WHERE url=\'' + yql + '\' AND xpath=\'//div[@class="container"]//div[@class="row"]//div[@class="table-responsive"]//table\''
  
  var self = {
    data:{},
    config: {pollutionColumn: 1}
  }//this;
  Y.YQL(yql, function(response) {
    if(response.error) {
      console.log(response.error.description)
    }
    else {
      self.data.city = response.query.results.table.caption.replace(/Dane pomiarowe tabele +|\t+|\(.+|\n +/gmi, '')
      var pollution
			response.query.results.table.tbody.tr.forEach(function(item, index){
				if(index < response.query.results.table.tbody.tr.length - 3) {
					pollution = parseFloat(item.td[self.config.pollutionColumn].replace(',', '.'))
					if(pollution) {
						self.data.pollution = pollution
					}
				}
			})
			self.loaded = true;
			//self.updateDom(self.animationSpeed);
    }
  });
  
  console.log(self);
});
</script></head></body></body></html>
